<%# customer %>
<h3>
<% if customer.new_record? %>
	新增客戶
<% else %>
	<%= "編輯客戶: #{customer.name}" %> 
<% end %>
</h3>

<%= form_tag "" do %>
	<div class="admin-customer-submit">	
		<% if customer.new_record? %>
			<%= link_to "儲存","",:class=>"btn btn-primary", :onClick=>"adminCustomer.create(event,this)" %>
		<% else %>
			<%= link_to "儲存","",:class=>"btn btn-primary", :onClick=>"adminCustomer.update(event,#{customer.id},this)" %>
		<% end %>			
	</div>

	<table class="table table-bordered">
		<tr>
			<td> <%= label_tag "customer[code]","編號" %> </td> 
			<td> <%= text_field_tag "customer[code]", customer.code, :required=>true %> </td>
			<td></td>
		</tr>
		<tr>
			<td> <%= label_tag "customer[name]","名字" %> </td> 
			<td> <%= text_field_tag "customer[name]", customer.name, :required=>true %> </td>
			<td></td>
		</tr>
		<tr>
			<td> <%= label_tag "customer[status]", "狀態" %> </td> 
			<td> <%= select_tag "customer[status]", options_for_select(["經營中","結束"],customer.status) %> 
			</td>
			<td></td>
		</tr>

		<% customer.addresses.each_with_index do |address,index| %>
			<% pre_text = "customer[addresses_attributes]" %>
			<tr index="<%=index%>">
				<td> 
					<%= hidden_field_tag "#{pre_text}[#{index}][id]", address.id %>
					<%= label_tag "#{pre_text}[#{index}][address]","地址#{index+1}" %> 
				</td> 
				<td> <%= text_field_tag "#{pre_text}[#{index}][address]",address.address %> </td>
				<td>
					<% if index== customer.addresses.length-1 %>
						<%= link_to "新增欄位","", :onClick=>"adminCustomer.addCustomerRow(event,this)", :class=>"btn btn-primary btn-xs" %> 					
						<%= link_to "移除欄位","", :onClick=>"adminCustomer.removeCustomerRow(event,this)", :class=>"btn btn-danger btn-xs" %>	
					<% end %>
				</td>
			</tr>
		<% end %>
		
		<% customer.phones.each_with_index do |phone,index| %>		
			<% pre_text = "customer[phones_attributes]" %>
			<tr index="<%=index%>" class="admin-form-customer-rows">
				<td> 
					<%= hidden_field_tag "#{pre_text}[#{index}][id]", phone.id %>
					<%= label_tag "#{pre_text}[#{index}][number]","電話#{index+1}" %> 
				</td> 
				<td>
					<%= text_field_tag "#{pre_text}[#{index}][number]",phone.number %> 
				</td>
				<td> 
					<% if index== customer.addresses.length-1 %>
						<%= link_to "新增欄位","", :onClick=>"adminCustomer.addCustomerRow(event,this)", :class=>"btn btn-primary btn-xs" %>
						<%= link_to "移除欄位","", :onClick=>"adminCustomer.removeCustomerRow(event,this)", :class=>"btn btn-danger btn-xs" %>	
					<% end %>
				</td>
			</tr>
		<% end %>

		<% customer.faxes.each_with_index do |fax,index| %>		
			<% pre_text = "customer[faxes_attributes]" %>
			<tr index="<%=index%>">
				<td> 
					<%= hidden_field_tag "#{pre_text}[#{index}][id]", fax.id %>
					<%= label_tag "#{pre_text}[#{index}][number]","傳真#{index+1}" %> 
				</td> 
				<td> <%= text_field_tag "#{pre_text}[#{index}][number]",fax.number %> </td>
				<td>
					<% if index== customer.addresses.length-1 %>
						<%= link_to "新增欄位","", :onClick=>"adminCustomer.addCustomerRow(event,this)", :class=>"btn btn-primary btn-xs" %> 		
						<%= link_to "移除欄位","", :onClick=>"adminCustomer.removeCustomerRow(event,this)", :class=>"btn btn-danger btn-xs" %>	

					<% end %>
				</td>
			</tr>
		<% end %>
	</table>
<% end %> <%# form tag %>

