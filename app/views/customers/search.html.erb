<div class="heading-box">
	<div class="heading-inner">
		<div class="info-box">
			<h2 class="title">
			  客戶清單(搜尋共 <%= @customers.count %> 筆)
			</h2>

			<div class="message">
				<% if flash[:success].present? %>
					<div class="success"> <%= flash[:success] %> </div>
				<% elsif flash[:fail].present? %>
					<div class="fail"> <%= flash[:fail] %> </div>
				<% end %>
			</div>

			<ul class="sub-nav">
				<li> <%= link_to "全部", customers_path %> </li>
				<li> <%= link_to "搜尋", search_customers_path, :class=>"selected" %> </li>
			</ul>			
		</div>

		<div class="submit-box"> 
			<%= link_to "新增客戶", new_customer_path ,:class=>"btn btn-primary add-new-daily-form" %>
		</div>
	</div>
</div>

<div class="content-box">
	<div class="content-inner">

		<div class="customer-search">
				<%= form_tag search_customers_path, :method=>:get do %>
					<div class="box1">
						<%= text_field_tag "customer_search", {}, :value=> @customer_search %>
						<%= submit_tag "搜尋", :class=>"btn btn-primary btn-xs" %>		
					</div>
					<div class="box2">
						<div class="field">
							<%= hidden_field_tag "customer_code", 0 %>
							<%= check_box_tag "customer_code",1, @customer_code %>
							<%= label_tag "customer_code", "編號" %>							
						</div>
						<div class="field">
							<%= hidden_field_tag "customer_name", 0 %>
							<%= check_box_tag "customer_name",1, @customer_name %>
							<%= label_tag "customer_name", "店名" %>							
						</div>
						<div class="field">
							<%= hidden_field_tag "customer_address", 0 %>
							<%= check_box_tag "customer_address", 1, @customer_address %>
							<%= label_tag "customer_address", "地址" %>							
						</div>
						<div class="field">
							<%= hidden_field_tag "customer_phone", 0 %>
							<%= check_box_tag "customer_phone",1, @customer_phone %>
							<%= label_tag "customer_phone", "電話" %>							
						</div>
						<%= select_tag "customer_city", options_for_select(City.all.map{|c| [c.name, c.id]}, @customer_city), :prompt=>"全部縣市" %>						
					</div>
				<% end %>
		</div>

		<table class="table table-striped customer-index-table">
			<thead>
				<tr>
					<th width="5%"></th>
					<th width="10%"> 編號 </th>
					<th width="15%"> 名字 </th>
					<th width="10%"> 縣市 </th>
					<th width="10%"> 地區 </th>
					<th width="20%"> 地址 </th>
					<th width="20%"> 電話 </th>
					<th width="5%"></th>
				</tr>
			</thead>

			<tbody>
				<% @customers.each_with_index do |customer,index| %>
				<tr>
					<td> <%= index+1 %> </td>
					<td> <%= customer.code %> </td>
					<td> <%= customer.name %> </td>
					<td> <%= customer.addresses.first.city.try(:name) if customer.addresses.first %> </td>
					<td> <%= customer.addresses.first.district.try(:name) if customer.addresses.first %> </td>
					<td>
						<%= customer.addresses.first.try(:address) %>
					</td>

					<td> <%= customer.phones.map{|p| p.number}.join(',') %> </td>
					<td> <%= link_to "基本資料",customer_path(customer), :class=>"btn btn-warning btn-xs" %> </td>
				</tr>
				<% end %>
				

			</tbody>
		</table>
		

	</div> <%# content-inner %>
</div> <%# content-box %>


